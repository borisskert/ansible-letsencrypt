[Unit]
Description = letsencrypt certificate renew service

[Service]
ExecStartPre = -/usr/bin/docker pull {{image_name}}:{{image_version}}

ExecStart = /usr/bin/docker run --rm --name letsencrypt \
              --volume "{{config_volume}}:/etc/letsencrypt" \
              --volume "{{data_volume}}:/var/lib/letsencrypt" \
              --volume "{{www_volume}}:/www" \
              --volume "{{log_folder}}:/var/log/letsencrypt" \
              {{image_name}}:{{image_version}} \
              renew -a webroot \
                    --webroot-path=/www \
                    --non-interactive \
                    --email {{email}} \
                    --agree-tos \
                    --rsa-key-size {{keysize}}

ExecStopPost  = -/bin/systemctl start {{nginx_reload_service_name}}

Restart = no
TimeoutSec = 3600
